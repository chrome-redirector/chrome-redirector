<!-- Options page.

     Copyright (C) 2010-2012.

     This file is part of Redirector.

     Redirector is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or
     (at your option) any later version.

     Redirector is distributed in the hope that it will be useful,
     but WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     GNU General Public License for more details.

     You should have received a copy of the GNU General Public License
     along with Redirector.  If not, see <http://www.gnu.org/licenses/>.

     From Cyril Feng. -->

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;
                                             charset=utf-8">
    <title i18n="PAGE_TITLE"></title>
    <script src="/js/common.js" type="text/javascript"></script>
    <script src="/js/prompt.js" type="text/javascript"></script>
    <script src="/js/pref.js" type="text/javascript"></script>
    <script src="/js/rule.js" type="text/javascript"></script>
    <script src="/js/debugger.js" type="text/javascript"></script>
    <script src="/js/options.js" type="text/javascript"></script>
    <link rel="stylesheet" href="/css/options.css" type="text/css">
  </head>

  <body onload="$f.initOpt()">
    <!-- Navigation bar -->
    <div id="navBar">
      <h1>Redirector</h1>

      <ul id="navTags">
        <li id="prefTag">
          <a href="#pref" i18n="PREF_TITLE"
             onclick="$f.switchNav()"></a>
        </li>
        <li id="ruleMgrTag">
          <a href="#ruleMgr" i18n="RULEMGR_TITLE"
             onclick="$f.switchNav()"></a>
        </li>
        <li id="dbgTag">
          <a href="#dbg" i18n="DBG_TITLE"
             onclick="$f.switchNav()"></a>
        </li>
        <li id="docTag">
          <a href="#doc" i18n="DOC_TITLE"
             onclick="$f.switchNav()"></a>
        </li>
      </ul>
    </div>

    <!-- The main display part -->
    <div id="main-container">
      <div id="main">
        <!-- Page for Preferences -->
        <div id="pref">
          <h1 i18n="PREF_TITLE"></h1>

          <!-- Proto settings -->
          <h3 i18n="PROTO_TITLE"></h3>
          <section>
            <details>
              <summary>
                <input type="checkbox" id="pref_proto_all"
                       onclick="$v.pref.onChgProto('all')" />
                <label i18n="PROTO_ALL"></label><br />
              </summary>

              <section>
                <input type="checkbox" id="pref_proto_http"
                       onclick="$v.pref.onChgProto('http')" />
                <label>HTTP://</label><br />
                <input type="checkbox" id="pref_proto_https"
                       onclick="$v.pref.onChgProto('https')" />
                <label>HTTPS://</label><br />
                <input type="checkbox" id="pref_proto_ftp"
                       onclick="$v.pref.onChgProto('ftp')" />
                <label>FTP://</label><br />
                <input type="checkbox" id="pref_proto_file"
                       onclick="$v.pref.onChgProto('file')" />
                <label>FILE://</label><br />
              </section>
            </details>
          </section>

          <!-- Context menu settings -->
          <h3 i18n="CONTEXT_TITLE"></h3>
          <section>
            <input type="checkbox" id="pref_context_link"
                   onclick="$v.pref.onChgContext()" />
            <label i18n="CONTEXT_LINK"></label><br />
            <input type="checkbox" id="pref_context_page"
                   onclick="$v.pref.onChgContext()" />
            <label i18n="CONTEXT_PAGE"></label><br />
          </section>

          <!-- Input prompt settings -->
          <h3 i18n="PROMPT"></h3>
          <section>
            <input type="checkbox" id="pref_prompt"
                   onclick="$v.pref.onChgPrompt()" />
            <label i18n="PROMPT_CHKBOX"></label>
          </section>
        </div>

        <!-- Page for rules -->
        <div id="ruleMgr" class="mainview">
          <h1 i18n="RULEMGR_TITLE"></h1>

          <!-- Rules list -->
          <h3 i18n="LBL_TITLE"></h3>
          <section>
            <div class="div-center">
              <input type="button" i18n="value:BTN_NEW"
                     onclick="$v.ruleList.add()" />
              <input type="button" i18n="value:BTN_EDIT"
                     onclick="$v.ruleList.edit()" />
              <input type="button" i18n="value:BTN_DEL"
                     onclick="$v.ruleList.del()" />
              <input type="button" i18n="value:BTN_UP"
                     onclick="$v.ruleList.move(-1)" />
              <input type="button" i18n="value:BTN_DOWN"
                     onclick="$v.ruleList.move(1)" />
            </div>

            <table id="ruleListTable">
              <colgroup>
               <col width="4%">
                <col width="24%" span="4">
              </colgroup>
              <tr>
                <th i18n="LBL_NAME" colspan="2"></th>
                <th i18n="LBL_MATCH"></th>
                <th i18n="LBL_SUB"></th>
                <th i18n="LBL_REPL"></th>
              </tr>
            </table>
          </section>

          <!-- Backup rule list -->
          <section>
            <details onclick="scroll(0, 0)">
              <summary i18n="RULEMGR_BAK_TITLE"></summary>

              <p>
                <input type="button"
                       i18n="value:BTN_BAK;title:BTN_BAK_TITLE"
                       onclick="$v.ruleList.bak()" />
              </p><p>
                <input type="button"
                       i18n="value:BTN_RESTORE;title:BTN_RESTORE_TITLE"
                       onclick="$v.ruleList.restore()" />
                <input type="file" id="ruleEdit_restoreFile"
                       accept="text/plain" />
              </p><p>
                <input type="button"
                       i18n="value:BTN_EXPORT;title:BTN_EXPORT_TITLE"
                       onclick="$v.ruleList.bak(true)" />
              </p><p>
                <input type="button"
                       i18n="value:BTN_IMPORT;title:BTN_IMPORT_TITLE"
                       onclick="$v.ruleList.restore(true)" />
                <input type="file" id="ruleEdit_appendFile"
                       accept="text/plain" />
              </p>
            </details>
          </section>
        </div>

        <!-- Page for debugger -->
        <div id="dbg" class="mainview">
          <h1 i18n="DBG_TITLE"></h1>

          <form onsubmit="return false;">
            <input type="url" id="dbg_url"
                   class="input-text"
                   i18n="placeholder:PH_DEBUG_URL" required />
            <input type="checkbox"
                   onchange="$v.debugger.quiet=this.checked" />
            <label i18n="DBG_QUIET"></label>
            <input type="checkbox" checked
                   onchange="$v.debugger.trackRedir=this.checked" />
            <label i18n="DBG_TRACK_REDIR"></label>
            <input type="checkbox" checked
                   onchange="$v.debugger.trackReqHdr=this.checked" />
            <label i18n="DBG_TRACK_REQHDR"></label>
            <input type="checkbox" checked
                   onchange="$v.debugger.trackRespHdr=this.checked" />
            <label i18n="DBG_TRACK_RESPHDR"></label>
            <input type="checkbox"
                   onchange="$v.debugger.testSpeed=this.checked" />
            <label i18n="DBG_TEST_SPEED"></label>

            <div class="action-area">
              <input type="submit" id="dbg_start"
                     i18n="value:BTN_DBG_START"
                     onclick="this.hidden=true;
                              $('dbg_stop').hidden=false;
                              $v.debugger.start()" />
              <input type="button" id="dbg_stop" hidden="true"
                     i18n="value:BTN_DBG_STOP"
                     onclick="this.hidden=true;
                              $('dbg_start').hidden=false;
                              $v.debugger.stop()" />
              <input type="button" id="dbg_unfold" hidden="true"
                     i18n="value:BTN_DBG_UNFOLD"
                     onclick="this.hidden=true;
                              $('dbg_fold').hidden=false;
                              $v.debugger.openDetails(true)" />
              <input type="button" id="dbg_fold" hidden="true"
                     i18n="value:BTN_DBG_FOLD"
                     onclick="this.hidden=true;
                              $('dbg_unfold').hidden=false;
                              $v.debugger.openDetails(false)" />
              <input type="button" i18n="value:BTN_DBG_CLEAR"
                     onclick="$('dbg_unfold').hidden=true;
                              $('dbg_fold').hidden=true;
                              $('dbg_info').innerHTML=''" />
            </div>
          </form>

          <div id="dbg_info">
          </div>

          <details onclick="scroll(0, 0)">
            <summary i18n="DBG_INFO_EXPORT"></summary>

            <p>
              <input type="button"
                     i18n="value:BTN_EXPORT;title:BTN_DBG_EXPORT_TITLE"
                     onclick="$v.debugger.export()" />
            </p><p>
              <input type="button"
                     i18n="value:BTN_IMPORT;title:BTN_DBG_IMPORT_TITLE"
                     onclick="$v.debugger.import()" />
              <input type="file" id="dbg_importFile"
                     accept="text/plain" />
            </p>
          </details>
        </div>

        <!-- Page for docs -->
        <div id="doc" class="mainview">
          <h1 i18n="DOC_TITLE"></h1>

          <section>
            <h3>
              <a href="/html/en.html" target="_blank">English</a>
            </h3>
            <h3>
              <a href="/html/zh_CN.html" target="_blank">中文(简体)</a>
            </h3>
          </section>
        </div>

        <div id="overlay">
          <!-- Rule Editor -->
          <div id="layerFront">
            <section>
              <h1 i18n="RULE_EDITOR"></h1>
            </section>
            <!-- Main form -->
            <form id="ruleEdit" onsubmit="return false;"
                  autocomplete="off">
              <section id="ruleEdit_name">
                <!-- Rule name -->
                <h3 i18n="LBL_NAME"></h3>
                <br />
                <input id="ruleEdit_namestr" i18n="placeholder:PH_NAME"
                       required />
              </section>

              <section id="ruleEdit_match">
                <!-- Match pattern -->
                <h3 i18n="LBL_MATCH"></h3>
                <select id="ruleEdit_matchtype"
                        onchange="$v.ruleList.onChgMatchType()">
                  <option selected="selected" i18n="TYPE_REGEXP">
                  </option>
                  <option i18n="TYPE_GLOB"></option>
                  <option i18n="TYPE_MANUAL"></option>
                </select>
                <input type="checkbox" id="ruleEdit_matchcase" />
                <label i18n="LBL_IGNCASE"></label>
                <br />
                <input id="ruleEdit_matchstr"
                       i18n="placeholder:PH_MATCH" required />
              </section>

              <section id="ruleEdit_sub">
                <!-- Substitution -->
                <h3 i18n="LBL_SUB"></h3>
                <select id="ruleEdit_subtype"
                        onchange="$v.ruleList.onChgSubType()">
                  <option selected="selected" i18n="TYPE_REGEXP">
                  </option>
                  <option i18n="TYPE_GLOB"></option>
                  <option i18n="TYPE_BLOCK"></option>
                  <option i18n="TYPE_REQ_HDR"></option>
                  <option i18n="TYPE_RESP_HDR"></option>
                </select>
                <input type="checkbox" id="ruleEdit_subcase" />
                <label i18n="LBL_IGNCASE"></label>
                <input type="checkbox" id="ruleEdit_subglob" />
                <label i18n="LBL_SUBGLOB"></label>
                <br />
                <input id="ruleEdit_substr"
                       i18n="placeholder:PH_SUB" required />
              </section>

              <section id="ruleEdit_repl">
                <!-- Replacement -->
                <h3 i18n="LBL_REPL"></h3>
                <input type="checkbox" id="ruleEdit_replDecode" />
                <label i18n="LBL_REPLDECODE"></label>
                <br />
                <input id="ruleEdit_replstr" i18n="placeholder:PH_REPL" />
              </section>

              <!-- Save/Cancel buttons -->
              <section>
                <div class="action-area">
                  <input type="submit" i18n="value:BTN_SAVE"
                         onclick="$v.ruleList.save()" />
                  <input type="button" i18n="value:BTN_CANCEL"
                         onclick="$v.ruleList.discard()" />
                </div>
              </section>
            </form>

            <hr />

            <!-- Test form -->
            <form onsubmit="return false;" autocomplete="off">
              <section>
                <details id="ruleEdit_test">
                  <summary i18n="LBL_TEST"></summary>

                  <input type="url" id="ruleEdit_teststr"
                         class="input-text"
                         i18n="placeholder:PH_TEST_URL" required />
                  <div class="action-area">
                    <input type="submit" i18n="value:BTN_TEST"
                           onclick="$v.ruleList.test()" />
                  </div>
                </details>
              </section>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Notification layer -->
    <div id="layerNotif" onclick="this.className=''">
      <div  class="div-center">
        <div id="layerNotif_disp"></div>
      </div>
  </body>
</html>
